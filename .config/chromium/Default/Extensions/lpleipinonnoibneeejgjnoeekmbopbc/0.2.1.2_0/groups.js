var groupStorage=groupStorage||[],groupOrdinalSort=function(a,c){return a.ord-c.ord};function groupAdd(a,c){a=tryIntParse(a);var b=groupGet(a);b?b.name=c:b=groupStorage[groupStorage.push({id:a,name:c,ord:groupStorage.length,list:[]})-1];return b}function groupExist(a){a=tryIntParse(a);return groupStorage.some(function(c){return c.id===a})}function groupNameExist(a){var c=a.toLowerCase();return groupStorage.some(function(a){return a.name.toLowerCase()===c})}
function groupGet(a){a=tryIntParse(a);var c=null,b="";switch(a){case actionKind.All:b="All";break;case actionKind.Extensions:b="Extensions";break;case actionKind.Applications:b="Applications";break;case actionKind.Themes:b="Themes";break;case actionKind.Enabled:b="Enabled";break;case actionKind.Disabled:b="Disabled";break;case actionKind.Outdated:b="Disabled";break;case actionKind.Recently:b="Disabled"}a>=actionKind.Group&&a<actionKind.GroupEnd?groupStorage.some(function(b){return b.id===a?(c=b,!0):
!1}):b&&(c={id:a,name:b});return c}function groupInd(a){a=tryIntParse(a);for(var c=groupStorage.length;0<=--c;)if(groupStorage[c].id===a)return c;return-1}function groupGetFreeId(){var a=groupStorage.map(function(a){return a.id}),c=actionKind.Group+1;if(a&&0<a.length){a.sort(function(a,b){return a-b});var b=0;do{if(a[b]>c)break;c=a[b]+1}while(++b<a.length)}c>actionKind.GroupEnd&&(c=actionKind.GroupEnd);a=null;return c}
function groupDelete(a,c){var b=!1;c&&(c.stopPropagation(),c.preventDefault());var d=groupGet(a);if(d)return confirm("Remove group '"+d.name+"'?")&&(actionRemoveGroup(d),groupRemove(a),groupSave(),b=!0),b}function groupNext(a,c){var b=null,d="number"===typeof a?a:"id"in a?a.id:actionKind.Group,e=groupStorage.length;for(;0<=--e;){if(groupStorage[e].id==d){!b&&0<e&&(b=groupStorage[e-1]);break}if(!c||groupStorage[e].id!==actionKind.Group)b=groupStorage[e]}return b}
function groupEditName(a){var c=groupGet(a),b="";if(c&&(b=prompt("Enter group name:",c.name))){b=b.trim();if(!b)return!1;b.toLowerCase();c.name.toLowerCase();var d=!1;c.name=b;c.id===actionKind.Group&&(d=!0,c.id=groupGetFreeId());groupSave();if(a=document.querySelector('[data-id="'+a+'"] > a'))a.innerText=b;d&&(actionRemoveGroup({id:actionKind.Group}),actionAddGroup(c))}}function groupSwitchOn(){}function groupSwitchPreset(){}function groupSwitchOff(){}function groupUndo(){}
function groupRedo(){}function groupSave(){localStorage.groups=JSON.stringify(groupStorage);return groupStorage}function groupsLoad(){try{groupStorage=JSON.parse(localStorage.groups)}catch(a){groupStorage=[]}groupStorage=groupStorage||[];groupStorage.sort(groupOrdinalSort);return groupStorage}function groupRemove(a){a=tryIntParse(a);groupStorage.splice(groupInd(a),1);return groupStorage}function groupsOrder(){groupStorage.sort(groupOrdinalSort);return groupStorage}
function groupCopy(){return groupStorage}function groupPurge(a){if(a=groupGet(a))a.list=[];return a}function groupAddItem(a,c){var b=groupGet(a);if(!b)return null;b.list=b.list||[];groupGetItem(a,c)||b.list.push({id:c,ord:b.list.length});groupSave();return b}function groupGetItem(a,c){var b=null,d=groupGet(a);if(!d)return null;d.list=d.list||[];d.list.some(function(a){return a.id===c?(b=a,!0):!1});return b}
function groupRemoveItem(a,c){var b=groupGet(a);if(!b)return null;var d=getExtById(c);d&&confirm("Remove '"+d.name+"' from current group?")&&(b.list.some(function(a,d){return a.id===c?(b.list.splice(d,1),!0):!1}),groupSave());return b}function groupOrderItem(a){return groupGet(a)}function groupRenameDialogue(a){a=groupGet(a);var c=a.name;if(c=prompt("Enter group name:",a.name))a.name=c,groupSave();return!0}
function groupDuplicateFunc(a,c,b){var d=groupGet(a);if(c&&c.length){var e=0;for(i=0;i<c.length;i++)if(!(void 0!==b&&b)||b(c[i]))groupAddItem(a,c[i].id),e++;actionCheckNewGroup();a===currentAction&&doAction(currentAction);notify(e+" items "," attached to group '"+d.name+"'")}}function groupNew(){groupGet(actionKind.Group)};