(function(){var T=function(aq,av){if(!av){av=document}var au=[];try{var ap=document.evaluate(aq,av,null,7,null);for(var at=0;at<ap.snapshotLength;at++){au.push(ap.snapshotItem(at))}}catch(ar){au=[]}return au};var ag=function(aq,at){if(!at){at=document}try{var ap=at.evaluate(aq,at,null,9,null);if(ap.singleNodeValue){return ap.singleNodeValue}else{return}}catch(ar){return}};var r=function(ap){if((document.querySelectorAll(ap)).length==1){return true}else{return false}};var n=function(ap,aq){if((T(ap,aq)).length==1){return true}else{return false}};var H=function(){this.i=-1;this.list=[]};H.prototype.next=function(){this.i++;if(this.i<this.list.length){var ap=this.list[this.i];ap.apply(this)}};H.prototype.append=function(ap){this.list.push(ap)};var al=function(at,aq){for(var ar=0,ap=aq.length;ar<ap;ar++){if(aq[ar]==at){return true}}return false};var F=0;var z=1;var q=2;var ab=-1;var K=F;var J=0;var G=1;var h=J;var ai;var d=0;var I=1;var v=2;var w=3;var x,a,C,D,X,N,e,E,am,U;var V=[];var B=[];var p,ae,j;var ah=20;var u=300;var ao;var aa=[];var i=function(aq){var ap=document.createElement("a");ap.href=aq;return(ap.href)};var o=function(ap){return(ap.replace(/([-()\[\]{}+?.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"))};var ad=[];var s=function(){var at=ad.length;var ap,aq;ap="";if(ao.OPTION_PAGE_NUMBERING){aq="("+at+") "}else{aq=""}var ar=af();if(!ar){ar=document.title}document.title=aq+ar+ap};var an=function(aq){if(location.href==aq){return false}for(var ar=0,ap=ad.length;ar<ap;ar++){if(ad[ar].nextURL==aq){return false}}return true};var f=function(ar,ap,at){if(ai==d||ai==I){if(ad.length==0){ad.push({element:ar,nextURL:ap,title:at})}else{ad.push({nextURL:ap,title:at})}}else{if(ai==v||ai==w){if(ai==v){var aq=function(au){return((function(av){return av.top+av.height})(au.getBoundingClientRect()))};ar.sort(function(av,au){return(aq(av)-aq(au))})}ad.push({elements:ar,nextURL:ap,title:at})}}if(ap&&ap!=""){c(ap,function(){})}};var af=function(){return((function(ap){return ap[ap.length-1]})(ad)).title};var l=function(){return((function(ap){return ap[ap.length-1]})(ad)).nextURL};var b=function(){if(ai==d||ai==I){return ad[0].element}else{if(ai==v||ai==w){var ap=function(aq){return aq[aq.length-1]};return(ap(ap(ad).elements))}}};var g=function(aq){if(ai==v){var ap=function(ar){return ar[ar.length-1]};ap(ad).elements.push(aq)}};var S=[];var c=function(aq,av){var au;for(var ar=0,ap=S.length;ar<ap;ar++){if(S[ar].url==aq){if(S[ar].parsed==true){av("onload",S[ar].data)}else{if(S[ar].error==true){av("onerror")}else{S[ar].addEventListener(av)}}return}}var at=function(ax,aA){if(E==false){var ay=new XMLHttpRequest()}else{if(E){var ay={}}}ay.url=ax;ay.eventListeners=[];ay.parsed=false;ay.error=false;var az=function(){try{var aE=ac(ay.responseText)}catch(aC){aw();return}if(ai==d||ai==I){if(!aE.fragment){aw();return}}if(ai==v||ai==w){if(!aE.elements||aE.elements==[]){aw();return}}for(var aD=0,aB=ay.eventListeners.length;aD<aB;aD++){(ay.eventListeners[aD])("onload",aE)}ay.data=aE;ay.parsed=true};var aw=function(){for(var aC=0,aB=ay.eventListeners.length;aC<aB;aC++){(ay.eventListeners[aC])("onerror")}ay.error=true};ay.onload=az;ay.onerror=aw;ay.addEventListener=function(aB){ay.eventListeners.push(aB)};ay.addEventListener(aA);if(E==false){ay.open("GET",ax,true);ay.send()}else{if(E){var aA=function(aB){if(aB!=""){ay.responseText=aB;ay.onload()}else{if(aB==""){ay.onerror()}}};chrome.extension.sendRequest({action:"xhr",url:ay.url},aA)}}return ay};S.push(at(aq,av))};var M=function(ap){var ar=document.implementation.createHTMLDocument("HTML");var aq=((function(at){at.selectNodeContents(document.documentElement);return at})(document.createRange())).createContextualFragment(ap);ar.documentElement.appendChild((function(at){at.appendChild(aq);return at})(ar.querySelector("BODY")));return ar};var ac=function(aF){var az=[];if(location.host=="www.youtube.com"){var ax=aF.match(/data-thumb="([^"]*)"/g);if(ax){for(var aL=0,aI=ax.length;aL<aI;aL++){var aN=function(aP){if(!aP){return}else{return aP[1]}};var ay=aN((/"([^"]*)"/).exec(ax[aL]));az.push(location.protocol+ay)}}}var aN=function(aP){if(!aP){return}else{return aP[1]}};var av=aN((/<title>([\s\S]*)<\/title>/i).exec(aF));var aC=document.implementation.createHTMLDocument("HTML");var aO=aC.querySelector("head");aO.innerHTML=av;av=aO.innerText.replace(/\s*$/g,"");if(ai==d||ai==v||ai==w){var aM=M(aF);if(U){(function(aR){for(var aQ=0,aP=aR.length;aQ<aP;aQ++){(function(aS){aS.parentNode.removeChild(aS)})(aR[aQ])}})(aM.querySelectorAll("SCRIPT"))}var aB,aG=ag(p,aM);if(aG){aG=document.importNode(aG,true);aB=aG?aG.href:null}if(location.host=="www.youtube.com"){var aq=aM.querySelectorAll("img[data-thumb]");for(var aL=0,aI=Math.min(aq.length,az.length);aL<aI;aL++){aq[aL].src=az[aL]}}if(ai==d){var aE=document.createRange();var aJ=ag(ae,aM);aE.selectNodeContents(document.importNode(aJ,true));var ap=aE.extractContents();return({fragment:ap,nextURL:aB,nextTitle:av})}else{if(ai==v||ai==w){var aD=T(ae,aM);var ar=[];for(var aL=0,aI=aD.length;aL<aI;aL++){var au=document.importNode(aD[aL],true);ar.push(au)}return({elements:ar,nextURL:aB,nextTitle:av})}}}else{if(ai==I){var aA;for(var aL=0,aI=V.length;aL<aI;aL++){var aN=function(aP){if(!aP){return}else{return aP[1]}};var at=aN((new RegExp(V[aL],"i")).exec(aF));if(at){aA=at;break}}var ap=((function(aP){aP.selectNodeContents(document.documentElement);return aP})(document.createRange())).createContextualFragment(aA);if(U){var aH=ap.querySelectorAll("SCRIPT");for(var aL=0,aI=aH.length;aL<aI;aL++){(function(aP){aP.parentNode.removeChild(aP)})(aH[aL])}}if(location.host=="www.youtube.com"){var aq=ap.querySelectorAll("img[data-thumb]");for(var aL=0,aI=Math.min(aq.length,az.length);aL<aI;aL++){aq[aL].src=az[aL]}}var aK;for(var aL=0,aI=B.length;aL<aI;aL++){var aN=function(aP){if(!aP){return}else{return aP[aP.length-1]}};var aw=aN(aF.match(new RegExp(B[aL],"ig")));var aN=function(aP){if(!aP){return}else{return aP[aP.length-1]}};var at=aN((/href(?:[\s]*)?=(?:[\s]*)?["']([^"']+)["']/i).exec(aw));if(at){aK=at;break}}var aB=aK?i(aK):null;return({fragment:ap,nextURL:aB,nextTitle:av})}}};var m=function(){var ap=document.createElement("div");ap.style.textAlign="center";ap.style.margin="15px 5px";ap.style.clear="both";ap.style.fontSize="12px";return ap};var Y=function(ar,ap){if(ai==v){var aq=b();if(aq.nextElementSibling){aq.parentNode.insertBefore(ar,aq.nextElementSibling)}else{aq.parentNode.appendChild(ar)}if(ap){g(ar)}}else{(b()).appendChild(ar)}};var A=function(av){var aq=m();var ay=document.createElement("a");ay.href=l();ay.appendChild(document.createTextNode(ad.length+1));aq.appendChild(document.createTextNode("Page: "));aq.appendChild(ay);Y(aq,true);if(ai==d||ai==I){var ax=av.fragment;(b()).appendChild(ax)}else{if(ai==v||ai==w){var at=b();var ap=av.elements;for(var aw=0,ar=ap.length;aw<ar;aw++){var au=ap[aw];if(at.nextElementSibling){at.parentNode.insertBefore(au,at.nextElementSibling)}else{at.parentNode.appendChild(au)}at=au}}}};var Q=function(ap){var aq=m();aq.appendChild(document.createTextNode(ap));Y(aq,false)};var Z="__ajax_loader__";var R=function(){var ar=b();var aq=document.getElementById(Z);if(ar&&!aq){var ap=m();ap.id=Z;ap.appendChild(document.createTextNode("Loading..."));Y(ap,false);ap.animate()}};var t=function(){var ap=document.getElementById(Z);if(ap){ap.parentNode.removeChild(ap)}};var O=function(){if(h!=G){return}h=J;var aq=document.title;document.title="Loading...";try{R()}catch(ap){}var ar=function(at,au){if(at=="onload"){if(!au.nextURL||au.nextURL==""||!an(au.nextURL)){K=q}document.title=aq;if(!E){s();(function(av){if(av){aa.push({title:document.title,url:av})}})(l())}A(au);if(ai==d||ai==I||ai==w){f(null,au.nextURL,au.nextTitle)}else{if(ai==v){f(au.elements,au.nextURL,au.nextTitle)}}if(K==q){Q("End")}s();t();setTimeout(function(){h=G;W()},ah)}else{if(at=="onerror"){K=ab;t();Q("Error");document.title=aq}}};c(l(),ar)};var W=function(aq){if(K!=z){return}if(h!=G){return}var ap=(function(at){return at.getBoundingClientRect()})(b());if(ap.top+ap.height-window.innerHeight-u<0){var ar=function(at){if(JSON.parse(at)){O()}};chrome.extension.sendRequest({action:"getState"},ar)}};var P=0;var y=function(ap){if(ap.button==0){P=(new Date()).getTime()}};var k=function(av){av.stopImmediatePropagation();var aq=(new Date()).getTime()-P;if(K==z||K==q){document.body.scrollTop=0;if(ao.OPTION_APPEND_HISTORY&&aq<1000){var au=document.title;var at=String((new Date()).getTime());chrome.extension.sendRequest({action:"pushHistoryKey",key:at},function(){});for(var ar=0,ap=aa.length;ar<ap;ar++){document.title=aa[ar].title;if(ar==0){history.replaceState(JSON.stringify({key:at}),null,location.href)}history.pushState(JSON.stringify({key:at}),null,aa[ar].url)}document.title=au}else{if(aa.length>0){document.title=aa[0].title}}}};var L=function(aq){if(aq.state){try{var ar=JSON.parse(aq.state)}catch(ap){}var at=function(au){if(JSON.parse(au)){chrome.extension.sendRequest({action:"delHistoryKey",key:ar.key},function(){})}else{location.reload()}};chrome.extension.sendRequest({action:"checkHistoryKey",key:ar.key},at)}};window.addEventListener("popstate",L,true);var ak=function(au,ax,aw,ap,aq,av,at,ar){var ay=function(aO){if(av=="Pager"||av=="Pagerize"){var aQ={};aQ.n=ap;aQ.x=aw;aQ.u=at;if(aq){aQ.j=1}else{aQ.j=0}if(ar){aQ.r=1}else{aQ.r=0}chrome.extension.sendRequest({action:"putCacheData",dataJSON:JSON.stringify(aQ)},function(){})}ao=JSON.parse(aO);ae=aw;p=ap;if(aq){U=false}else{U=true}var aN=ax.href;var aM=(/(.+?:)\/\/(.+?)(\/.+)/i).exec(aN)[1];var aC=(/(.+?):\/\/(.+?)(\/.+)/i).exec(aN)[2];if((aC?(aC!=location.host):false)||(aM?(aM!=location.protocol):false)){E=true}else{E=false}var aG=(/(.*\/)[^\/]*/i).exec(location.href)[1];var aA=(/(.*\/)[^\/]*/i).exec(aN)[1];if(!aG||!aA||(aG!=aA)){am=true}else{am=false}var aD=T(ae);if(av=="MicroFormat"){ai=w;f(aD,aN,document.title)}else{if(aD.length>1||au.tagName=="TR"){ai=v;f(aD,aN,document.title)}else{var aE=au;var aI=aE.tagName.toLowerCase();var aH=au.nextElementSibling;var az=aH?aH.tagName.toLowerCase():null;if(ao.OPTION_DOM_DIRECT){if(aE.id){x=true}else{x=false}a=false;if(aE.className){if(n("//"+aI+'[@class="'+aE.className+'"]')){a=true}}if(aH){if(aH.id){C=true}else{C=false}D=false;if(aH.className){if(n("following::"+az+'[@class="'+aH.className+'"]',aE)){D=true}}}if(ax){if(ax.id){X=true}else{X=false}if(ax.rel){e=true}else{e=false}N=false;if(ax.className){if(n('//a[@class="'+ax.className+'"]')){N=true}}}}if((x||a)&&(C||D)&&(X||e||N)&&ao.OPTION_DOM_DIRECT){var aJ,aP;var aB=[],aF=[];if(x){aB.push("<"+aI+"(?:[\\s][^>]*)?id(?:[\\s]*)?=(?:[\\s]*)?['\"]"+o(aE.id)+"['\"](?:[\\s][^>]*)?>")}if(a){aB.push("<"+aI+"(?:[\\s][^>]*)?class(?:[\\s]*)?=(?:[\\s]*)?['\"]"+o(aE.className)+"['\"](?:[\\s][^>]*)?>")}if(C){aF.push("<"+az+"(?:[\\s][^>]*)?id(?:[\\s]*)?=(?:[\\s]*)?['\"]"+o(aH.id)+"['\"](?:[\\s][^>]*)?>")}if(D){aF.push("<"+az+"(?:[\\s][^>]*)?class(?:[\\s]*)?=(?:[\\s]*)?['\"]"+o(aH.className)+"['\"](?:[\\s][^>]*)?>")}for(var aL=0;aL<aB.length;aL++){for(var aK=0;aK<aF.length;aK++){V.push(aB[aL]+"([\\s\\S]*)"+aF[aK])}}if(X){B.push("<a(?:[\\s][^>]*)?id(?:[\\s]*)?=(?:[\\s]*)?['\"]"+o(ax.id)+"['\"](?:[\\s][^>]*)?>")}if(e){B.push("<a(?:[\\s][^>]*)?rel(?:[\\s]*)?=(?:[\\s]*)?['\"]"+o(ax.rel)+"['\"](?:[\\s][^>]*)?>")}if(N){B.push("<a(?:[\\s][^>]*)?class(?:[\\s]*)?=(?:[\\s]*)?['\"]"+o(ax.className)+"['\"](?:[\\s][^>]*)?>")}ai=I;f(au,aN,document.title)}else{ai=d;f(au,aN,document.title)}}}document.title=document.title.replace(/\s*$/g,"");K=z;h=G;window.addEventListener("scroll",W,false);window.addEventListener("unload",k,true);window.addEventListener("click",y,true);W()};chrome.extension.sendRequest({action:"getOptions"},ay)};var aj=function(){K=F;var ap=new H();var au=function(aF,aE){var aD,aH,aG,az;for(var aB=0,aA=aF.length;aB<aA;aB++){var aC=ag(aF[aB].contentXPath);var aI=ag(aF[aB].linkXPath);if(aC&&aI){aD=aC;aH=aI;aG=aF[aB].contentXPath;az=aF[aB].linkXPath;break}}if(aD&&aH){ak(aD,aH,aG,az,false,aE)}else{ap.next()}};var at=function(){var az=[];az.push({contentXPath:'//*[contains(concat(" ",@class," "), " autopagerize_page_element ")]',linkXPath:'//a[@rel="next"] | //link[@rel="next"]'});az.push({contentXPath:'//*[contains(concat(" ",@class," "), " hfeed ") or contains(concat(" ",@class," "), " xfolkentry ")]',linkXPath:'//link[@rel="next"] | //a[contains(concat(" ",@rel," "), " next ")] | //a[contains(concat(" ",@class," "), " next ")]'});au(az,"MicroFormat")};var ay=function(){var az=[];au(az,"GenericFormat")};var aw=function(){var az=function(aD){if(!aD){ap.next();return}var aH;try{aH=JSON.parse(aD)}catch(aF){ap.next();return}for(var aE=0,aB=aH.length;aE<aB;aE++){var aJ=aH[aE].pageElement;var aA=aH[aE].nextLink;var aG=ag(aJ);if(!aG){continue}if(aG.tagName=="BODY"){continue}var aI=ag(aA);if(!aI){continue}if(!aI.href){continue}if((/^javascript/i).test(aI.href)){continue}var aC=aH[aE].url;ak(aG,aI,aJ,aA,false,"Pagerize",aC,true);return}ap.next()};chrome.extension.sendRequest({action:"getPagerizeData",url:location.href},az)};var ar=function(){var az=function(aE){if(!aE){ap.next();return}var aI;try{aI=JSON.parse(aE)}catch(aG){ap.next();return}for(var aF=0;aF<aI.length;aF++){var aK=aI[aF].x;var aA=aI[aF].n;var aB=aI[aF].j;var aH=ag(aK);if(!aH){continue}if(aH.tagName=="BODY"){continue}var aJ=ag(aA);if(!aJ){continue}if(!aJ.href){continue}if((/^javascript/i).test(aJ.href)){continue}var aD=aI[aF].u;var aC=aI[aF].r;ak(aH,aJ,aK,aA,aB,"Pager",aD,aC);return}ap.next()};chrome.extension.sendRequest({action:"getPagerData",url:location.href},az)};var ax=function(){var az=function(aE){if(!aE){ap.next();return}var aI;try{aI=JSON.parse(aE)}catch(aG){ap.next();return}for(var aF=0;aF<aI.length;aF++){var aK=aI[aF].x;var aA=aI[aF].n;var aB=aI[aF].j;var aH=ag(aK);if(!aH){continue}if(aH.tagName=="BODY"){continue}var aJ=ag(aA);if(!aJ){continue}if(!aJ.href){continue}if((/^javascript/i).test(aJ.href)){continue}var aD=aI[aF].u;var aC=aI[aF].r;ak(aH,aJ,aK,aA,aB,"Cache",aD,aC);return}ap.next()};chrome.extension.sendRequest({action:"getCacheData",url:location.href},az)};var av=function(az){if(JSON.parse(az)){ap.append(ax);ap.append(aw);ap.append(ar);ap.append(at);ap.next()}else{ap.append(ax);ap.append(ar);ap.append(aw);ap.append(at);ap.next()}};var aq=function(az){if(JSON.parse(az)){chrome.extension.sendRequest({action:"checkLang",url:location.href},av)}};chrome.extension.sendRequest({action:"checkExceptions",url:location.href},aq)};if(window==window.top){document.addEventListener("DOMContentLoaded",function(ap){aj()},true)}})();