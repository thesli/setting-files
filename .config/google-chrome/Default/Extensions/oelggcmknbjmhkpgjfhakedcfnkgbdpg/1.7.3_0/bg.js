function setItem(e,t){try{window.localStorage.removeItem(e),window.localStorage.setItem(e,t)}catch(n){}}function getItem(e){var t;try{t=window.localStorage.getItem(e)}catch(n){t="false"}return t}function clearStorage(){window.localStorage.clear()}function injectEditor(){typeof localStorage.warn=="undefined"&&setItem("warn","true"),typeof localStorage.save=="undefined"&&setItem("save","true"),typeof localStorage.keycode=="undefined"&&setItem("keycode",69),chrome.tabs.insertCSS(null,{file:"css_editor.css"});var e=getItem("warn")==="true"?!0:!1,t=getItem("save")==="true"?!0:!1,n=getItem("modify")==="true"?!0:!1,r="LiveCSSEditor({ warn : "+e+", save : "+t+", modify : "+n+" });";chrome.tabs.executeScript(null,{file:"css_editor.js"},function(e){chrome.tabs.executeScript(null,{code:r})})}function cleanupEditor(){chrome.tabs.executeScript(null,{file:"remove_editor.js"})}function loadExistingStyles(){chrome.tabs.executeScript(null,{file:"existing_styles.js"})}chrome.extension.onMessage.addListener(function(e,t,n){if(e.settings){n({setting:e.settings,value:getItem(e.settings)});return}if(e.modify){getItem("modify")==="true"&&(chrome.browserAction.setBadgeText({text:"*",tabId:t.tab.id}),loadExistingStyles()),n({});return}e.start&&injectEditor();if(e.stop){if(getItem("save")!=="true"&&getItem("warn")==="true"&&!confirm("Are you sure?"))return;cleanupEditor()}n({})}),chrome.browserAction.onClicked.addListener(function(e){injectEditor()});