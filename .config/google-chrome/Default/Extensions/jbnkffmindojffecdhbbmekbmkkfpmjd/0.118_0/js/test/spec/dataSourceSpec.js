define(["common/model/dataSource","enum/dataSourceType"],function(e,t){"use strict";describe("DataSource",function(){var u=function(e,t){t=t||{},expect(e.get("sourceId")).toEqual(void 0===t.sourceId?e.defaults.sourceId:t.sourceId),expect(e.get("type")).toEqual(void 0===t.type?e.defaults.type:t.type),expect(e.get("url")).toEqual(void 0===t.url?e.defaults.url:t.url)};it("Should initialize properly",function(){u(new e)}),it("Should be able to parse YouTube Playlist URLs",function(){var o;o=new e({urlToParse:"http://www.youtube.com/playlist?list=PL63F0C78739B09958"}),u(o,{sourceId:"63F0C78739B09958",type:t.YouTubePlaylist,url:"https://gdata.youtube.com/feeds/api/playlists/63F0C78739B09958"}),o=new e({urlToParse:"http://www.youtube.com/playlist?p=PL63F0C78739B09958"}),u(o,{sourceId:"63F0C78739B09958",type:t.YouTubePlaylist,url:"https://gdata.youtube.com/feeds/api/playlists/63F0C78739B09958"})}),it("Should be able to parse YouTube Favorites URLs",function(){var o;o=new e({urlToParse:"http://www.youtube.com/playlist?list=FL-SyDtP6JOvHZVcRrZrXnyA"}),u(o,{sourceId:"-SyDtP6JOvHZVcRrZrXnyA",type:t.YouTubeFavorites,url:"https://gdata.youtube.com/feeds/api/users/-SyDtP6JOvHZVcRrZrXnyA/favorites"}),o=new e({urlToParse:"http://www.youtube.com/playlist?p=FL-SyDtP6JOvHZVcRrZrXnyA"}),u(o,{sourceId:"-SyDtP6JOvHZVcRrZrXnyA",type:t.YouTubeFavorites,url:"https://gdata.youtube.com/feeds/api/users/-SyDtP6JOvHZVcRrZrXnyA/favorites"})}),it("Should be able to parse YouTube Channel URLs",function(){var o;o=new e({urlToParse:"http://www.youtube.com/channel/UCXIyz409s7bNWVcM-vjfdVA"}),u(o,{sourceId:"UCXIyz409s7bNWVcM-vjfdVA",type:t.YouTubeChannel,url:"https://gdata.youtube.com/feeds/api/users/UCXIyz409s7bNWVcM-vjfdVA/uploads"}),o=new e({urlToParse:"http://www.youtube.com/user/majesticcasual"}),u(o,{sourceId:"majesticcasual",type:t.YouTubeChannel,url:"https://gdata.youtube.com/feeds/api/users/majesticcasual/uploads"}),o=new e({urlToParse:"http://www.youtube.com/playlist?list=UU-e1BqfubuSdFPHauQwZmlg"}),u(o,{sourceId:"-e1BqfubuSdFPHauQwZmlg",type:t.YouTubeChannel,url:"https://gdata.youtube.com/feeds/api/users/-e1BqfubuSdFPHauQwZmlg/uploads"}),o=new e({urlToParse:"http://www.youtube.com/playlist?p=UU-e1BqfubuSdFPHauQwZmlg"}),u(o,{sourceId:"-e1BqfubuSdFPHauQwZmlg",type:t.YouTubeChannel,url:"https://gdata.youtube.com/feeds/api/users/-e1BqfubuSdFPHauQwZmlg/uploads"})}),it("Should be able to parse YouTube Auto-Generated Playlist URLs",function(){var o;o=new e({urlToParse:"http://www.youtube.com/playlist?p=ALYL4kY05133rTMhTulSaXKj_Y6el9q0JH"}),u(o,{sourceId:"ALYL4kY05133rTMhTulSaXKj_Y6el9q0JH",type:t.YouTubeAutoGenerated}),o=new e({urlToParse:"http://www.youtube.com/playlist?list=ALYL4kY05133rTMhTulSaXKj_Y6el9q0JH"}),u(o,{sourceId:"ALYL4kY05133rTMhTulSaXKj_Y6el9q0JH",type:t.YouTubeAutoGenerated})}),xit("Should be able to parse Streamus Shared Playlist URLs",function(){}),xit("Should have a properly working success callback for getTitle",function(){var t=!1,u=new e({urlToParse:"http://www.youtube.com/playlist?list=PL63F0C78739B09958"});runs(function(){u.getTitle({success:function(){t=!0}})}),waitsFor(function(){return t},"DataSource should have called success",2e3)}),it("Should have a properly working error callback for getTitle",function(){var t=!1,u=new e({urlToParse:"http://www.youtube.com/playlist?list=sdfsdfsdfsdfsdf"});runs(function(){u.getTitle({notifyOnError:!1,error:function(){t=!0}})}),waitsFor(function(){return t},"DataSource should have called error",2e3)}),it("Should be able to get a youtube playlist title",function(){var t=new e({urlToParse:"http://www.youtube.com/playlist?list=PL63F0C78739B09958"});runs(function(){t.getTitle()}),waitsFor(function(){return""!==t.get("title")},"DataSource should have retrieved its title",1e3),runs(function(){expect(t.get("title")).toEqual("Music Playlist")})}),it("Should be able to get a youtube channel name",function(){var t=new e({urlToParse:"http://www.youtube.com/channel/UCXIyz409s7bNWVcM-vjfdVA"});runs(function(){t.getTitle()}),waitsFor(function(){return""!==t.get("title")},"DataSource should have retrieved its title",2e3),runs(function(){expect(t.get("title")).toEqual("Majestic Casual")})}),xit("Should be able to get a YouTube auto-generated playlist title",function(){var t=new e({urlToParse:"http://www.youtube.com/playlist?p=ALYL4kY05133rTMhTulSaXKj_Y6el9q0JH"});runs(function(){t.getTitle()}),waitsFor(function(){return""!==t.get("title")},"DataSource should have retrieved its title",2e3),runs(function(){expect(t.get("title")).toEqual("Top Tracks for Kendrick Lamar")})}),it("Should be able to successfully indicate whether it is a V3 YouTube API source",function(){var u;u=new e({type:t.YouTubeAutoGenerated}),expect(u.isV3()).toEqual(!0),u=new e({type:t.YouTubeChannel}),expect(u.isV3()).toEqual(!1)}),it("Should be able to successfully indicate whether it needsLoading",function(){var u;u=new e({type:t.YouTubeChannel}),expect(u.needsLoading()).toEqual(!0),u=new e({type:t.YouTubePlaylist}),expect(u.needsLoading()).toEqual(!0),u=new e({type:t.YouTubeFavorites}),expect(u.needsLoading()).toEqual(!0),u=new e({type:t.YouTubeAutoGenerated}),expect(u.needsLoading()).toEqual(!0),u=new e({type:t.None}),expect(u.needsLoading()).toEqual(!1),u=new e({type:t.Unknown}),expect(u.needsLoading()).toEqual(!1),u=new e({type:t.SharedPlaylist}),expect(u.needsLoading()).toEqual(!1),u=new e({type:t.UserInput}),expect(u.needsLoading()).toEqual(!1)}),it("Should be able to parse a YouTube video id from a variety of URL patterns",function(){expect((new e).parseYouTubeVideoIdFromUrl("http://www.youtube.com/watch?v=6od4WeaWDcs")).toEqual("6od4WeaWDcs"),expect((new e).parseYouTubeVideoIdFromUrl("http://youtu.be/3sg6KCayu0E")).toEqual("3sg6KCayu0E"),expect((new e).parseYouTubeVideoIdFromUrl("http://www.youtube.com/watch?feature=youtu.be&v=aKpLrmQsS_M")).toEqual("aKpLrmQsS_M"),expect((new e).parseYouTubeVideoIdFromUrl("http://www.youtube.com/watch?feature=player_embedded&v=MKS8Jn_3bnA")).toEqual("MKS8Jn_3bnA"),expect((new e).parseYouTubeVideoIdFromUrl("http://youtu.be/3sg6KCau0E")).toEqual(null),expect((new e).parseYouTubeVideoIdFromUrl("http://youtu.be/3sg6KaaCau0E")).toEqual(null)})})});